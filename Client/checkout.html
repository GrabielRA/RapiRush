<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - RapiRush</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
        <div class="container">
            <a class="navbar-brand fw-bold text-warning" href="index.html">
              <h3>üöö RapiRush</h3>
            </a>
            <div class="text-muted">
                <i class="bi bi-lock-fill"></i> Pago seguro
            </div>
        </div>
    </nav>

    <!-- Breadcrumb -->
    <div class="container my-3">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="index.html">Inicio</a></li>
                <li class="breadcrumb-item"><a href="carrito.html">Carrito</a></li>
                <li class="breadcrumb-item active">Checkout</li>
            </ol>
        </nav>
    </div>

    <!-- Contenido Principal -->
    <div class="container my-4">
        <h2 class="fw-bold mb-4">Finalizar pedido</h2>

        <div class="row">
            <!-- Formulario de datos -->
            <div class="col-lg-7">
                <!-- Informaci√≥n de entrega -->
                <div class="card shadow-sm mb-4">
                    <div class="card-body">
                        <h5 class="card-title fw-bold mb-3">
                            <i class="bi bi-geo-alt-fill text-primary"></i> Informaci√≥n de entrega
                        </h5>
                        
                        <form id="checkout-form">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="firstName" class="form-label">Nombre *</label>
                                    <input type="text" class="form-control" id="firstName" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="lastName" class="form-label">Apellido *</label>
                                    <input type="text" class="form-control" id="lastName" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="phone" class="form-label">Tel√©fono *</label>
                                    <input type="tel" class="form-control" id="phone" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="email" class="form-label">Email *</label>
                                    <input type="email" class="form-control" id="email" required>
                                </div>
                                <div class="col-12">
                                    <label for="address" class="form-label">Direcci√≥n *</label>
                                    <input type="text" class="form-control" id="address" placeholder="Calle, n√∫mero, distrito" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="reference" class="form-label">Referencia</label>
                                    <input type="text" class="form-control" id="reference" placeholder="Ej: Casa azul, al lado del parque">
                                </div>
                                <div class="col-md-6">
                                    <label for="district" class="form-label">Distrito *</label>
                                    <select class="form-select" id="district" required>
                                        <option value="">Seleccionar distrito</option>
                                        <option value="miraflores">Miraflores</option>
                                        <option value="san-isidro">San Isidro</option>
                                        <option value="surco">Surco</option>
                                        <option value="la-molina">La Molina</option>
                                        <option value="san-borja">San Borja</option>
                                    </select>
                                </div>
                                <div class="col-12">
                                    <label for="notes" class="form-label">Notas adicionales</label>
                                    <textarea class="form-control" id="notes" rows="2" placeholder="Instrucciones especiales para el repartidor"></textarea>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- M√©todos de pago -->
                <div class="card shadow-sm mb-4">
                    <div class="card-body">
                        <h5 class="card-title fw-bold mb-3">
                            <i class="bi bi-credit-card-fill text-primary"></i> M√©todo de pago
                        </h5>

                        <div class="payment-methods">
                            <!-- Efectivo -->
                            <div class="form-check payment-card mb-3">
                                <input class="form-check-input" type="radio" name="paymentMethod" id="cash" value="cash" checked>
                                <label class="form-check-label d-flex align-items-center w-100" for="cash">
                                    <i class="bi bi-cash-coin fs-3 me-3 text-success"></i>
                                    <div>
                                        <strong>Efectivo</strong>
                                        <p class="mb-0 small text-muted">Paga al recibir tu pedido</p>
                                    </div>
                                </label>
                            </div>

                            <!-- Tarjeta de cr√©dito/d√©bito -->
                            <div class="form-check payment-card mb-3">
                                <input class="form-check-input" type="radio" name="paymentMethod" id="card" value="card">
                                <label class="form-check-label d-flex align-items-center w-100" for="card">
                                    <i class="bi bi-credit-card fs-3 me-3 text-primary"></i>
                                    <div>
                                        <strong>Tarjeta de cr√©dito/d√©bito</strong>
                                        <p class="mb-0 small text-muted">Visa, Mastercard, American Express</p>
                                    </div>
                                </label>
                            </div>

                            <!-- Yape/Plin -->
                            <div class="form-check payment-card mb-3">
                                <input class="form-check-input" type="radio" name="paymentMethod" id="digital" value="digital">
                                <label class="form-check-label d-flex align-items-center w-100" for="digital">
                                    <i class="bi bi-phone fs-3 me-3 text-info"></i>
                                    <div>
                                        <strong>Yape / Plin</strong>
                                        <p class="mb-0 small text-muted">Pago digital instant√°neo</p>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <!-- Secci√≥n de datos de tarjeta (oculta por defecto) -->
                        <div id="card-details-section" class="card-details-section" style="display: none;">
                            <h6 class="fw-bold mb-3">
                                <i class="bi bi-shield-lock-fill"></i> Datos de la tarjeta
                            </h6>
                            
                            <div class="row g-3">
                                <div class="col-12">
                                    <label for="cardNumber" class="form-label">N√∫mero de tarjeta *</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="cardNumber" 
                                               placeholder="1234 5678 9012 3456" maxlength="19">
                                        <span class="input-group-text">
                                            <i class="bi bi-credit-card-2-front"></i>
                                        </span>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <label for="cardName" class="form-label">Nombre en la tarjeta *</label>
                                    <input type="text" class="form-control" id="cardName" 
                                           placeholder="Como aparece en la tarjeta">
                                </div>
                                <div class="col-md-6">
                                    <label for="cardExpiry" class="form-label">Fecha de expiraci√≥n *</label>
                                    <input type="text" class="form-control" id="cardExpiry" 
                                           placeholder="MM/AA" maxlength="5">
                                </div>
                                <div class="col-md-6">
                                    <label for="cardCvv" class="form-label">CVV *</label>
                                    <input type="text" class="form-control" id="cardCvv" 
                                           placeholder="123" maxlength="4">
                                    <small class="text-muted">
                                        <i class="bi bi-info-circle"></i> 3 o 4 d√≠gitos al reverso
                                    </small>
                                </div>
                            </div>

                            <div class="alert alert-info mt-3 mb-0">
                                <i class="bi bi-shield-check"></i>
                                <small>Tu informaci√≥n est√° protegida con encriptaci√≥n SSL de 256 bits</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bot√≥n de confirmar -->
                <div class="d-grid gap-2 mb-4">
                    <button type="button" class="btn btn-primary btn-lg" onclick="confirmOrder()">
                        <i class="bi bi-check-circle"></i> Confirmar pedido
                    </button>
                    <a href="carrito.html" class="btn btn-outline-secondary">
                        <i class="bi bi-arrow-left"></i> Volver al carrito
                    </a>
                </div>
            </div>

            <!-- Resumen del pedido (sticky) -->
            <div class="col-lg-5">
                <div class="order-summary">
                    <h5 class="fw-bold mb-4">Resumen del pedido</h5>

                    <!-- Items del pedido -->
                    <div id="order-items-list" class="mb-3">
                        <!-- Se llenar√° din√°micamente -->
                    </div>

                    <hr>

                    <!-- Desglose de precios -->
                    <div class="d-flex justify-content-between mb-2">
                        <span>Subtotal</span>
                        <span id="summary-subtotal">S/. 0.00</span>
                    </div>
                    <div class="d-flex justify-content-between mb-2">
                        <span>Delivery</span>
                        <span id="summary-delivery">S/. 0.00</span>
                    </div>
                    <div class="d-flex justify-content-between mb-2 text-success">
                        <span>Descuento</span>
                        <span id="summary-discount">- S/. 0.00</span>
                    </div>
                    
                    <hr>
                    
                    <div class="d-flex justify-content-between mb-3">
                        <strong class="fs-5">Total</strong>
                        <strong class="text-primary fs-4" id="summary-total">S/. 0.00</strong>
                    </div>

                    <!-- Tiempo estimado -->
                    <div class="alert alert-success">
                        <i class="bi bi-clock-fill"></i>
                        <strong>Tiempo estimado:</strong> 30-40 min
                    </div>

                    <!-- Informaci√≥n adicional -->
                    <div class="small text-muted mt-3">
                        <p class="mb-1">
                            <i class="bi bi-check-circle-fill text-success"></i> 
                            Pago 100% seguro
                        </p>
                        <p class="mb-1">
                            <i class="bi bi-check-circle-fill text-success"></i> 
                            Seguimiento en tiempo real
                        </p>
                        <p class="mb-0">
                            <i class="bi bi-check-circle-fill text-success"></i> 
                            Garant√≠a de satisfacci√≥n
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de confirmaci√≥n -->
    <div class="modal fade" id="confirmModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center py-5">
                    <i class="bi bi-check-circle-fill text-success" style="font-size: 4rem;"></i>
                    <h3 class="mt-3 fw-bold">¬°Pedido confirmado!</h3>
                    <p class="text-muted">Tu pedido ha sido recibido y est√° siendo preparado</p>
                    <p class="fw-bold">N√∫mero de pedido: #<span id="order-number"></span></p>
                    <div class="d-grid gap-2 mt-4">
                        <a href="dashboard/cliente.html" class="btn btn-primary">Ver mis pedidos</a>
                        <a href="index.html" class="btn btn-outline-secondary">Volver al inicio</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- ‚úÖ ORDEN CORRECTO: carrito.js PRIMERO -->
    <script src="assets/js/auth.js"></script>
    <script src="assets/js/session.js"></script>
    <script src="assets/js/carrito.js"></script>
    <script src="assets/js/checkout.js"></script>
</body>
</html>